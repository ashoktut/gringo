<div class="submissions-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <h1>
        <mat-icon>assignment_turned_in</mat-icon>
        Submissions Management
      </h1>
      <p class="page-description">Monitor and manage all RFQ submissions and responses</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" (click)="createNewSubmission()" matTooltip="Create new submission manually">
        <mat-icon>add</mat-icon>
        New Submission
      </button>
      <button mat-icon-button (click)="loadSubmissions()" matTooltip="Refresh submissions list">
        <mat-icon>refresh</mat-icon>
      </button>
      <button mat-icon-button (click)="exportSubmissions()" matTooltip="Export submissions data">
        <mat-icon>download</mat-icon>
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card" matTooltip="Total submissions received">
      <mat-card-content>
        <div class="stat-icon total">
          <mat-icon>assignment</mat-icon>
        </div>
        <div class="stat-content">
          <h3>{{ stats.total }}</h3>
          <p>Total Submissions</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card" matTooltip="Submissions awaiting review">
      <mat-card-content>
        <div class="stat-icon pending">
          <mat-icon>pending_actions</mat-icon>
        </div>
        <div class="stat-content">
          <h3>{{ stats.pending }}</h3>
          <p>Pending Review</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card" matTooltip="Approved submissions">
      <mat-card-content>
        <div class="stat-icon approved">
          <mat-icon>check_circle</mat-icon>
        </div>
        <div class="stat-content">
          <h3>{{ stats.approved }}</h3>
          <p>Approved</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card" matTooltip="Rejected submissions">
      <mat-card-content>
        <div class="stat-icon rejected">
          <mat-icon>cancel</mat-icon>
        </div>
        <div class="stat-content">
          <h3>{{ stats.rejected }}</h3>
          <p>Rejected</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Filter and Search Section -->
  <mat-card class="filter-card">
    <mat-card-content>
      <div class="filter-controls">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search submissions</mat-label>
          <input matInput [(ngModel)]="searchQuery" (ngModelChange)="applyFilters()" placeholder="Search by company, RFQ, or reference..." matTooltip="Search across all submission fields">
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Status Filter</mat-label>
          <mat-select [(ngModel)]="statusFilter" (ngModelChange)="applyFilters()" matTooltip="Filter by submission status">
            <mat-option value="">All Statuses</mat-option>
            <mat-option value="pending">Pending</mat-option>
            <mat-option value="approved">Approved</mat-option>
            <mat-option value="rejected">Rejected</mat-option>
            <mat-option value="in-review">In Review</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Date Range</mat-label>
          <mat-select [(ngModel)]="dateFilter" (ngModelChange)="applyFilters()" matTooltip="Filter by submission date">
            <mat-option value="">All Time</mat-option>
            <mat-option value="today">Today</mat-option>
            <mat-option value="week">This Week</mat-option>
            <mat-option value="month">This Month</mat-option>
            <mat-option value="quarter">This Quarter</mat-option>
          </mat-select>
        </mat-form-field>

        <button mat-stroked-button (click)="clearFilters()" matTooltip="Clear all filters">
          <mat-icon>clear</mat-icon>
          Clear Filters
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Submissions Table -->
  <mat-card class="submissions-table-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>list</mat-icon>
        Submissions List
      </mat-card-title>
      <div class="table-actions">
        <button mat-icon-button matTooltip="Column settings">
          <mat-icon>view_column</mat-icon>
        </button>
        <button mat-icon-button matTooltip="Sort options">
          <mat-icon>sort</mat-icon>
        </button>
      </div>
    </mat-card-header>

    <mat-card-content>
      <div class="table-container">
        <table mat-table [dataSource]="filteredSubmissions" class="submissions-table" matSort>

          <!-- Reference Column -->
          <ng-container matColumnDef="reference">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Reference</th>
            <td mat-cell *matCellDef="let submission">
              <div class="reference-cell">
                <strong>{{ submission.reference }}</strong>
                <span class="submission-type">{{ submission.type }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Company Column -->
          <ng-container matColumnDef="company">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Company</th>
            <td mat-cell *matCellDef="let submission">
              <div class="company-cell">
                <mat-icon class="company-icon">business</mat-icon>
                <div>
                  <div class="company-name">{{ submission.companyName }}</div>
                  <div class="contact-info">{{ submission.contactEmail }}</div>
                </div>
              </div>
            </td>
          </ng-container>

          <!-- Template Column -->
          <ng-container matColumnDef="template">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Template</th>
            <td mat-cell *matCellDef="let submission">
              <div class="template-cell">
                <mat-icon class="template-icon">description</mat-icon>
                <span>{{ submission.templateName }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Submitted</th>
            <td mat-cell *matCellDef="let submission">
              <div class="date-cell">
                <div class="date">{{ submission.submittedDate | date:'short' }}</div>
                <div class="time-ago">{{ getTimeAgo(submission.submittedDate) }}</div>
              </div>
            </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
            <td mat-cell *matCellDef="let submission">
              <mat-chip-set>
                <mat-chip [ngClass]="'status-' + submission.status" selected>
                  <mat-icon matChipAvatar>{{ getStatusIcon(submission.status) }}</mat-icon>
                  {{ getStatusLabel(submission.status) }}
                </mat-chip>
              </mat-chip-set>
            </td>
          </ng-container>

          <!-- Priority Column -->
          <ng-container matColumnDef="priority">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Priority</th>
            <td mat-cell *matCellDef="let submission">
              <mat-chip-set>
                <mat-chip [ngClass]="'priority-' + submission.priority" selected>
                  {{ submission.priority | titlecase }}
                </mat-chip>
              </mat-chip-set>
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let submission">
              <div class="action-buttons">
                <button mat-icon-button (click)="viewSubmission(submission)" matTooltip="View submission details">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button (click)="editSubmission(submission)" matTooltip="Edit submission">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button [matMenuTriggerFor]="actionMenu" matTooltip="More actions">
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #actionMenu="matMenu">
                  <button mat-menu-item (click)="approveSubmission(submission)">
                    <mat-icon>check_circle</mat-icon>
                    <span>Approve</span>
                  </button>
                  <button mat-menu-item (click)="rejectSubmission(submission)">
                    <mat-icon>cancel</mat-icon>
                    <span>Reject</span>
                  </button>
                  <button mat-menu-item (click)="duplicateSubmission(submission)">
                    <mat-icon>content_copy</mat-icon>
                    <span>Duplicate</span>
                  </button>
                  <mat-divider></mat-divider>
                  <button mat-menu-item (click)="downloadSubmission(submission)">
                    <mat-icon>download</mat-icon>
                    <span>Download PDF</span>
                  </button>
                  <button mat-menu-item (click)="emailSubmission(submission)">
                    <mat-icon>email</mat-icon>
                    <span>Send Email</span>
                  </button>
                  <mat-divider></mat-divider>
                  <button mat-menu-item (click)="deleteSubmission(submission)" class="danger-action">
                    <mat-icon>delete</mat-icon>
                    <span>Delete</span>
                  </button>
                </mat-menu>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"
              (click)="viewSubmission(row)"
              class="submission-row"
              matTooltip="Click to view details"></tr>
        </table>

        <!-- No Data State -->
        <div *ngIf="filteredSubmissions.length === 0" class="no-data">
          <mat-icon>inbox</mat-icon>
          <h3>No submissions found</h3>
          <p>{{ searchQuery || statusFilter || dateFilter ? 'Try adjusting your filters' : 'No submissions have been created yet' }}</p>
          <button mat-raised-button color="primary" (click)="createNewSubmission()" *ngIf="!searchQuery && !statusFilter && !dateFilter">
            <mat-icon>add</mat-icon>
            Create First Submission
          </button>
        </div>
      </div>

      <!-- Pagination -->
      <mat-paginator
        [pageSizeOptions]="[10, 25, 50, 100]"
        [pageSize]="25"
        showFirstLastButtons
        aria-label="Select page">
      </mat-paginator>
    </mat-card-content>
  </mat-card>

  <!-- Quick Actions FAB -->
  <div class="fab-container">
    <button mat-fab color="primary" [matMenuTriggerFor]="fabMenu" matTooltip="Quick actions">
      <mat-icon>add</mat-icon>
    </button>
    <mat-menu #fabMenu="matMenu" xPosition="before">
      <button mat-menu-item (click)="createNewSubmission()">
        <mat-icon>assignment</mat-icon>
        <span>New Submission</span>
      </button>
      <button mat-menu-item (click)="importSubmissions()">
        <mat-icon>upload</mat-icon>
        <span>Import Data</span>
      </button>
      <button mat-menu-item (click)="exportSubmissions()">
        <mat-icon>download</mat-icon>
        <span>Export All</span>
      </button>
    </mat-menu>
  </div>
</div>
