<div class="search-container" [class]="getContainerClasses()">
  <mat-form-field appearance="outline" class="search-field" [class.mat-focused]="isFocused">
    <mat-label>{{ config.placeholder || 'Search...' }}</mat-label>
    <input
      matInput
      [formControl]="searchControl"
      [placeholder]="config.placeholder || 'Search...'"
      type="text"
      (focus)="onFocus()"
      (blur)="onBlur()"
      (keydown.enter)="onEnterPressed()"
      (keydown.escape)="onEscapePressed()"
      #searchInput
    >
    <mat-icon matPrefix [class.search-loading]="isLoading">
      {{ isLoading ? 'sync' : 'search' }}
    </mat-icon>

    <button
      *ngIf="config.showClearButton && searchControl.value"
      mat-icon-button
      matSuffix
      (click)="clearSearch()"
      type="button"
      aria-label="Clear search"
      class="clear-button">
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>

  <!-- Search Hint -->
  <div class="search-hint" *ngIf="showHint && isFocused">
    <mat-icon>lightbulb</mat-icon>
    {{ getSearchHint() }}
  </div>

  <!-- Search Suggestions Dropdown -->
  <div class="search-suggestions" *ngIf="showSuggestions && suggestions.length > 0">
    <div
      class="search-suggestion"
      *ngFor="let suggestion of suggestions; trackBy: trackSuggestion"
      (click)="selectSuggestion(suggestion)"
      [attr.aria-label]="'Select suggestion: ' + suggestion.text">
      <mat-icon>{{ suggestion.icon || 'search' }}</mat-icon>
      <span>{{ suggestion.text }}</span>
      <mat-icon class="suggestion-arrow" *ngIf="suggestion.category">arrow_forward</mat-icon>
    </div>
  </div>

  <!-- No Results Message -->
  <div class="search-no-results" *ngIf="showNoResults">
    <mat-icon>search_off</mat-icon>
    <span>No results found for "{{ searchControl.value }}"</span>
  </div>
</div>
